<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ë§ˆíŠ¸ ì‹œê°„í‘œ ìƒì„±ê¸° - ëª…ì§€ëŒ€ ì»´í“¨í„°ê³µí•™ê³¼ (50+ ê³¼ëª©)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        .course-card {
            transition: all 0.3s ease;
        }
        .course-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .selected {
            background-color: #dbeafe;
            border-color: #3b82f6;
        }
        .timetable-grid {
            display: grid;
            grid-template-columns: 80px repeat(5, 1fr);
            gap: 1px;
            background-color: #e5e7eb;
        }
        .timetable-cell {
            background-color: white;
            min-height: 60px;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .timetable-header {
            background-color: #f3f4f6;
            font-weight: 600;
            color: #374151;
        }
        .course-slot {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            text-align: center;
        }
        .course-slot.required {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
        }
        .course-slot.elective {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }
        .course-slot.general {
            background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .filter-btn {
            transition: all 0.3s ease;
        }
        .filter-btn.active {
            background-color: #3b82f6;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- í—¤ë” -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                âš¡ ëª…ì§€ëŒ€í•™êµ ì»´í“¨í„°ê³µí•™ê³¼ ìŠ¤ë§ˆíŠ¸ ì‹œê°„í‘œ ìƒì„±ê¸°
            </h1>
            <p class="text-lg text-gray-600">
                50+ ê³¼ëª© ì¤‘ì—ì„œ 18í•™ì ì˜ í˜„ì‹¤ì ì¸ ìµœì í™”ëœ ì‹œê°„í‘œë¥¼ ìë™ ìƒì„±í•©ë‹ˆë‹¤
            </p>
            <div class="mt-4 flex justify-center space-x-8 text-sm text-gray-500">
                <div class="flex items-center">
                    <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                    ê°•ì˜ê°„ê²©: 1êµì‹œ ìš°ì„  (1ìˆœìœ„)
                </div>
                <div class="flex items-center">
                    <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                    ì—°ê°•ì œí•œ: 4êµì‹œ ì´í•˜ (2ìˆœìœ„)
                </div>
                <div class="flex items-center">
                    <span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>
                    ëª©í‘œ í•™ì : 18í•™ì 
                </div>
            </div>
        </div>

        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="grid grid-cols-1 md:grid-cols-6 gap-4 mb-6">
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="totalCourses">0</div>
                <div class="text-sm opacity-90">ì´ ê³¼ëª© ìˆ˜</div>
            </div>
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="selectedCourses">0</div>
                <div class="text-sm opacity-90">ì„ íƒëœ ê³¼ëª©</div>
            </div>
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="totalCredits">0</div>
                <div class="text-sm opacity-90">ì´ í•™ì </div>
            </div>
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="freeTime">0</div>
                <div class="text-sm opacity-90">ê³µê°• ì‹œê°„</div>
            </div>
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="continuousTime">0</div>
                <div class="text-sm opacity-90">ì—°ê°• ì‹œê°„</div>
            </div>
            <div class="stats-card rounded-lg p-4 text-center">
                <div class="text-2xl font-bold" id="scheduleScore">0</div>
                <div class="text-sm opacity-90">ìµœì í™” ì ìˆ˜</div>
            </div>
        </div>

        <!-- ìµœì í™” ì„¤ì • í‘œì‹œ -->
        <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ğŸ¯ ìµœì í™” ì„¤ì •</h3>
                    <div class="flex items-center space-x-6 text-sm text-gray-600">
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span>
                            ê°•ì˜ê°„ê²©: <strong>1êµì‹œ</strong> (1ìˆœìœ„)
                        </div>
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>
                            ì—°ê°•ì œí•œ: <strong>4êµì‹œ</strong> (2ìˆœìœ„)
                        </div>
                        <div class="flex items-center">
                            <span class="w-3 h-3 bg-purple-500 rounded-full mr-2"></span>
                            ëª©í‘œ í•™ì : <strong>18í•™ì </strong>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-600 mb-1">í˜„ì¬ ìµœì í™” ì ìˆ˜</div>
                    <div class="text-2xl font-bold text-blue-600" id="currentScore">0</div>
                </div>
            </div>
        </div>

        <!-- í•„í„° ë° ê²€ìƒ‰ -->
        <div class="bg-white rounded-lg shadow-lg p-4 mb-6">
            <div class="flex flex-wrap items-center gap-4">
                <div class="flex-1 min-w-64">
                    <input type="text" id="searchInput" placeholder="ê³¼ëª©ëª…, ì½”ë“œ, êµìˆ˜ëª…ìœ¼ë¡œ ê²€ìƒ‰..."
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div class="flex gap-2">
                    <button class="filter-btn px-3 py-2 border border-gray-300 rounded-lg text-sm" data-filter="all">ì „ì²´</button>
                    <button class="filter-btn px-3 py-2 border border-gray-300 rounded-lg text-sm" data-filter="required">ì „ê³µí•„ìˆ˜</button>
                    <button class="filter-btn px-3 py-2 border border-gray-300 rounded-lg text-sm" data-filter="elective">ì „ê³µì„ íƒ</button>
                    <button class="filter-btn px-3 py-2 border border-gray-300 rounded-lg text-sm" data-filter="general">êµì–‘</button>
                </div>
                <button onclick="autoSelectOptimal()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                    ğŸ¯ 18í•™ì  ìµœì í™” ì™„ì„±<br>
                    <span class="text-xs opacity-90">ì „ê³µí•„ìˆ˜ 3ê°œ, êµì–‘/ì „ê³µì„ íƒìœ¼ë¡œ ì™„ì„±</span>
                </button>
            </div>
        </div>

        <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- ì¢Œì¸¡: ê³¼ëª© ëª©ë¡ -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">
                        ğŸ“š ìˆ˜ê°• ê°€ëŠ¥ ê³¼ëª© (<span id="filteredCount">0</span>ê°œ)
                    </h3>
                    
                    <!-- ê³¼ëª© ëª©ë¡ -->
                    <div class="space-y-3 max-h-96 overflow-y-auto" id="courseList">
                        <!-- ê³¼ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>

            <!-- ìš°ì¸¡: ì„ íƒëœ ê³¼ëª© ë° ì‹œê°„í‘œ -->
            <div class="lg:col-span-2">
                <!-- ì„ íƒëœ ê³¼ëª© ëª©ë¡ -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">
                        ì„ íƒëœ ê³¼ëª© (<span id="selectedCount">0</span>ê°œ) - <span id="totalCredits2">0</span>í•™ì 
                    </h3>
                    <div class="space-y-2 mb-6" id="selectedCoursesList">
                        <!-- ì„ íƒëœ ê³¼ëª©ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                    <button onclick="generateTimetable()" id="generateBtn"
                            class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors">
                        âš¡ ìµœì  ì‹œê°„í‘œ ìƒì„±
                    </button>
                </div>

                <!-- ìƒì„±ëœ ì‹œê°„í‘œ -->
                <div class="bg-white rounded-lg shadow-lg p-6" id="timetableSection" style="display: none;">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">
                        ìƒì„±ëœ ì‹œê°„í‘œ
                    </h3>
                    <div class="timetable-grid" id="timetableGrid">
                        <!-- ì‹œê°„í‘œ ê·¸ë¦¬ë“œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 50ê°œ ì´ìƒì˜ ê³¼ëª© ë°ì´í„° ìƒì„± (ê³µê°• ìµœì í™”)
        const generateCourses = () => {
            const professors = [
                'ê¹€êµìˆ˜', 'ì´êµìˆ˜', 'ë°•êµìˆ˜', 'ìµœêµìˆ˜', 'ì •êµìˆ˜', 'í•œêµìˆ˜', 'ì¡°êµìˆ˜', 'ìœ¤êµìˆ˜',
                'ê°•êµìˆ˜', 'ì„êµìˆ˜', 'ì„œêµìˆ˜', 'ì˜¤êµìˆ˜', 'ì¥êµìˆ˜', 'ì‹ êµìˆ˜', 'ë¬¸êµìˆ˜', 'ì–‘êµìˆ˜'
            ];

            const rooms = [
                'A101', 'A102', 'A103', 'A201', 'A202', 'A203', 'A301', 'A302',
                'B101', 'B102', 'B103', 'B201', 'B202', 'B203', 'B301', 'B302',
                'C101', 'C102', 'C103', 'C201', 'C202', 'C203', 'C301', 'C302'
            ];

            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = [
                { start: '09:00', end: '10:30' },
                { start: '10:30', end: '12:00' },
                { start: '12:00', end: '13:30' },
                { start: '13:30', end: '15:00' },
                { start: '15:00', end: '16:30' },
                { start: '16:30', end: '18:00' },
                { start: '18:00', end: '19:30' }
            ];

            const courses = [];

            // ì „ê³µí•„ìˆ˜ ê³¼ëª© (í˜„ì‹¤ì ìœ¼ë¡œ 2-3ê°œë§Œ)
            const requiredCourses = [
                { name: 'ìë£Œêµ¬ì¡°', code: 'CS101' },
                { name: 'ì•Œê³ ë¦¬ì¦˜', code: 'CS102' },
                { name: 'ì»´í“¨í„°êµ¬ì¡°', code: 'CS103' }
            ];

            requiredCourses.forEach((course, index) => {
                const professor = professors[index % professors.length];
                // ì „ê³µí•„ìˆ˜ëŠ” ê°•ì˜ê°„ê²© ìµœì í™”ë¥¼ ìœ„í•´ í•µì‹¬ ì‹œê°„ëŒ€ì— ë°°ì¹˜
                const timeSlot = timeSlots[index * 2]; // 0, 2, 4 ì‹œê°„ëŒ€ (09:00, 12:00, 15:00)
                const day1 = days[index % days.length];
                const day2 = days[(index + 1) % days.length];
                const room = rooms[index % rooms.length];

                courses.push({
                    id: course.code,
                    name: course.name,
                    code: course.code,
                    professor,
                    credit: 3,
                    priority: 9,
                    isRequired: true,
                    category: 'required',
                    timeSlots: [
                        { day: day1, startTime: timeSlot.start, endTime: timeSlot.end, room },
                        { day: day2, startTime: timeSlot.start, endTime: timeSlot.end, room }
                    ]
                });
            });

            // ì „ê³µì„ íƒ ê³¼ëª© (ë‹¤ì–‘í•œ ì‹œê°„ëŒ€ì™€ ê³µê°• íŒ¨í„´)
            const electiveCourses = [
                { name: 'ì›¹í”„ë¡œê·¸ë˜ë°', code: 'CS201' },
                { name: 'ëª¨ë°”ì¼í”„ë¡œê·¸ë˜ë°', code: 'CS202' },
                { name: 'ì¸ê³µì§€ëŠ¥', code: 'CS203' },
                { name: 'ë¨¸ì‹ ëŸ¬ë‹', code: 'CS204' },
                { name: 'ì»´í“¨í„°ê·¸ë˜í”½ìŠ¤', code: 'CS205' },
                { name: 'ê²Œì„í”„ë¡œê·¸ë˜ë°', code: 'CS206' },
                { name: 'ì •ë³´ë³´ì•ˆ', code: 'CS207' },
                { name: 'í´ë¼ìš°ë“œì»´í“¨íŒ…', code: 'CS208' },
                { name: 'ë¹…ë°ì´í„°ë¶„ì„', code: 'CS209' },
                { name: 'IoTí”„ë¡œê·¸ë˜ë°', code: 'CS210' },
                { name: 'ë¸”ë¡ì²´ì¸', code: 'CS211' },
                { name: 'ì‚¬ì´ë²„ë³´ì•ˆ', code: 'CS212' },
                { name: 'UI/UXë””ìì¸', code: 'CS213' },
                { name: 'DevOps', code: 'CS214' },
                { name: 'ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤', code: 'CS215' },
                { name: 'ì¿ ë²„ë„¤í‹°ìŠ¤', code: 'CS216' },
                { name: 'ë„ì»¤', code: 'CS217' },
                { name: 'Reactí”„ë¡œê·¸ë˜ë°', code: 'CS218' },
                { name: 'Node.jsí”„ë¡œê·¸ë˜ë°', code: 'CS219' },
                { name: 'Pythoní”„ë¡œê·¸ë˜ë°', code: 'CS220' },
                { name: 'Javaí”„ë¡œê·¸ë˜ë°', code: 'CS221' },
                { name: 'C++í”„ë¡œê·¸ë˜ë°', code: 'CS222' },
                { name: 'Goí”„ë¡œê·¸ë˜ë°', code: 'CS223' },
                { name: 'Rustí”„ë¡œê·¸ë˜ë°', code: 'CS224' },
                { name: 'Swiftí”„ë¡œê·¸ë˜ë°', code: 'CS225' },
                { name: 'Kotliní”„ë¡œê·¸ë˜ë°', code: 'CS226' },
                { name: 'TypeScriptí”„ë¡œê·¸ë˜ë°', code: 'CS227' },
                { name: 'PHPí”„ë¡œê·¸ë˜ë°', code: 'CS228' },
                { name: 'Rubyí”„ë¡œê·¸ë˜ë°', code: 'CS229' },
                { name: 'C#í”„ë¡œê·¸ë˜ë°', code: 'CS230' },
                { name: 'Scalaí”„ë¡œê·¸ë˜ë°', code: 'CS231' },
                { name: 'Haskellí”„ë¡œê·¸ë˜ë°', code: 'CS232' },
                { name: 'Clojureí”„ë¡œê·¸ë˜ë°', code: 'CS233' },
                { name: 'Erlangí”„ë¡œê·¸ë˜ë°', code: 'CS234' },
                { name: 'Elixirí”„ë¡œê·¸ë˜ë°', code: 'CS235' },
                { name: 'F#í”„ë¡œê·¸ë˜ë°', code: 'CS236' },
                { name: 'OCamlí”„ë¡œê·¸ë˜ë°', code: 'CS237' },
                { name: 'Lispí”„ë¡œê·¸ë˜ë°', code: 'CS238' },
                { name: 'Prologí”„ë¡œê·¸ë˜ë°', code: 'CS239' },
                { name: 'Assemblyí”„ë¡œê·¸ë˜ë°', code: 'CS240' },
                { name: 'MATLABí”„ë¡œê·¸ë˜ë°', code: 'CS241' },
                { name: 'Rí”„ë¡œê·¸ë˜ë°', code: 'CS242' },
                { name: 'Juliaí”„ë¡œê·¸ë˜ë°', code: 'CS243' },
                { name: 'Luaí”„ë¡œê·¸ë˜ë°', code: 'CS244' },
                { name: 'Perlí”„ë¡œê·¸ë˜ë°', code: 'CS245' }
            ];

            electiveCourses.forEach((course, index) => {
                const professor = professors[(index + 8) % professors.length];
                // ê°•ì˜ê°„ê²© ìµœì í™”ë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ì‹œê°„ íŒ¨í„´ ìƒì„±
                const timeIndex = (index + 2) % timeSlots.length; // ì „ê³µí•„ìˆ˜, êµì–‘ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì˜¤í”„ì…‹
                const timeSlot = timeSlots[timeIndex];
                const day1 = days[(index + 2) % days.length];
                const day2 = days[(index + 4) % days.length];
                const room = rooms[(index + 8) % rooms.length];

                courses.push({
                    id: course.code,
                    name: course.name,
                    code: course.code,
                    professor,
                    credit: 3,
                    priority: Math.floor(Math.random() * 5) + 5, // 5-9
                    isRequired: false,
                    category: 'elective',
                    timeSlots: [
                        { day: day1, startTime: timeSlot.start, endTime: timeSlot.end, room },
                        { day: day2, startTime: timeSlot.start, endTime: timeSlot.end, room }
                    ]
                });
            });

            // êµì–‘ ê³¼ëª© (ê³µê°• ì‹œê°„ëŒ€ í™œìš©)
            const generalCourses = [
                { name: 'ì˜ì–´íšŒí™”', code: 'GE101' },
                { name: 'ì¤‘êµ­ì–´', code: 'GE102' },
                { name: 'ì¼ë³¸ì–´', code: 'GE103' },
                { name: 'ì² í•™ê°œë¡ ', code: 'GE104' },
                { name: 'ì‹¬ë¦¬í•™ê°œë¡ ', code: 'GE105' },
                { name: 'ê²½ì œí•™ê°œë¡ ', code: 'GE106' },
                { name: 'ì‚¬íšŒí•™ê°œë¡ ', code: 'GE107' },
                { name: 'ì—­ì‚¬í•™ê°œë¡ ', code: 'GE108' },
                { name: 'ë¬¸í•™ê°œë¡ ', code: 'GE109' },
                { name: 'ì˜ˆìˆ ì‚¬', code: 'GE110' },
                { name: 'ìŒì•…ì‚¬', code: 'GE111' },
                { name: 'ì²´ìœ¡', code: 'GE112' },
                { name: 'ìƒí™œì²´ìœ¡', code: 'GE113' },
                { name: 'ë´‰ì‚¬í™œë™', code: 'GE114' },
                { name: 'ì°½ì—…ë¡ ', code: 'GE115' },
                { name: 'ë…¼ë¦¬í•™', code: 'GE116' },
                { name: 'ìœ¤ë¦¬í•™', code: 'GE117' },
                { name: 'í™˜ê²½í•™', code: 'GE118' },
                { name: 'ê³¼í•™ì‚¬', code: 'GE119' },
                { name: 'ìˆ˜í•™ì‚¬', code: 'GE120' },
                { name: 'ë…ì¼ì–´', code: 'GE121' },
                { name: 'í”„ë‘ìŠ¤ì–´', code: 'GE122' },
                { name: 'ìŠ¤í˜ì¸ì–´', code: 'GE123' },
                { name: 'ëŸ¬ì‹œì•„ì–´', code: 'GE124' },
                { name: 'ì•„ëì–´', code: 'GE125' },
                { name: 'ì •ì¹˜í•™ê°œë¡ ', code: 'GE126' },
                { name: 'ë²•í•™ê°œë¡ ', code: 'GE127' },
                { name: 'êµìœ¡í•™ê°œë¡ ', code: 'GE128' },
                { name: 'í–‰ì •í•™ê°œë¡ ', code: 'GE129' },
                { name: 'êµ­ì œê´€ê³„ë¡ ', code: 'GE130' },
                { name: 'ë¬¸í™”ì¸ë¥˜í•™', code: 'GE131' },
                { name: 'ì§€ë¦¬í•™ê°œë¡ ', code: 'GE132' },
                { name: 'ìƒë¬¼í•™ê°œë¡ ', code: 'GE133' },
                { name: 'í™”í•™ê°œë¡ ', code: 'GE134' },
                { name: 'ë¬¼ë¦¬í•™ê°œë¡ ', code: 'GE135' },
                { name: 'í†µê³„í•™ê°œë¡ ', code: 'GE136' },
                { name: 'ì»´í“¨í„°í™œìš©', code: 'GE137' },
                { name: 'ì •ë³´ì²˜ë¦¬ë¡ ', code: 'GE138' },
                { name: 'ë¯¸ìˆ ì‚¬', code: 'GE139' },
                { name: 'ì˜í™”ì‚¬', code: 'GE140' },
                { name: 'ì—°ê·¹ì‚¬', code: 'GE141' },
                { name: 'ìŒì•…ì‚¬', code: 'GE142' },
                { name: 'ë¬´ìš©ì‚¬', code: 'GE143' },
                { name: 'ê±´ì¶•ì‚¬', code: 'GE144' },
                { name: 'ë””ìì¸ì‚¬', code: 'GE145' },
                { name: 'íŒ¨ì…˜ì‚¬', code: 'GE146' },
                { name: 'ìš”ë¦¬ì‚¬', code: 'GE147' },
                { name: 'ì—¬í–‰í•™', code: 'GE148' },
                { name: 'ê´€ê´‘í•™', code: 'GE149' },
                { name: 'í˜¸í…”ê²½ì˜í•™', code: 'GE150' }
            ];

            generalCourses.forEach((course, index) => {
                const professor = professors[(index + 16) % professors.length];
                // êµì–‘ì€ ê°•ì˜ê°„ê²© ìµœì í™”ë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ì‹œê°„ëŒ€ì— ë°°ì¹˜
                const timeIndex = (index + 1) % timeSlots.length; // ì „ê³µê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ì˜¤í”„ì…‹
                const timeSlot = timeSlots[timeIndex];
                const day = days[(index + 1) % days.length];
                const room = rooms[(index + 16) % rooms.length];

                courses.push({
                    id: course.code,
                    name: course.name,
                    code: course.code,
                    professor,
                    credit: 2,
                    priority: Math.floor(Math.random() * 3) + 3, // 3-5
                    isRequired: false,
                    category: 'general',
                    timeSlots: [
                        { day, startTime: timeSlot.start, endTime: timeSlot.end, room }
                    ]
                });
            });

            return courses;
        };

        const courses = generateCourses();
        let selectedCourses = [];
        let filteredCourses = [...courses];
        let currentFilter = 'all';

        // ì‹œê°„í‘œ ê·¸ë¦¬ë“œ ìƒì„±
        function createTimetableGrid() {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = [
                { time: '09:00', label: '1êµì‹œ' },
                { time: '10:30', label: '2êµì‹œ' },
                { time: '12:00', label: '3êµì‹œ' },
                { time: '13:30', label: '4êµì‹œ' },
                { time: '15:00', label: '5êµì‹œ' },
                { time: '16:30', label: '6êµì‹œ' },
                { time: '18:00', label: '7êµì‹œ' }
            ];

            let gridHTML = `
                <div class="timetable-header timetable-cell">ì‹œê°„</div>
                ${days.map(day => `<div class="timetable-header timetable-cell">${day}ìš”ì¼</div>`).join('')}
            `;

            timeSlots.forEach((timeSlot, rowIndex) => {
                gridHTML += `<div class="timetable-header timetable-cell">
                    <div>${timeSlot.time}</div>
                    <div class="text-xs text-gray-500">${timeSlot.label}</div>
                </div>`;
                
                days.forEach(day => {
                    const courseSlot = findCourseAtTime(day, timeSlot.time);
                    gridHTML += `<div class="timetable-cell">
                        ${courseSlot ? `
                            <div class="course-slot ${courseSlot.category}">
                                <div class="font-medium">${courseSlot.name}</div>
                                <div class="text-xs opacity-75">${courseSlot.professor}</div>
                                <div class="text-xs opacity-75">${courseSlot.room}</div>
                            </div>
                        ` : '-'}
                    </div>`;
                });
            });

            document.getElementById('timetableGrid').innerHTML = gridHTML;
        }

        // íŠ¹ì • ì‹œê°„ëŒ€ì— ìˆ˜ì—…ì´ ìˆëŠ”ì§€ ì°¾ê¸°
        function findCourseAtTime(day, time) {
            for (let course of selectedCourses) {
                for (let slot of course.timeSlots) {
                    if (slot.day === day && slot.startTime === time) {
                        return {
                            name: course.name,
                            professor: course.professor,
                            room: slot.room,
                            category: course.category
                        };
                    }
                }
            }
            return null;
        }

        // ê³¼ëª© ì„ íƒ/í•´ì œ
        function toggleCourse(courseId) {
            const course = courses.find(c => c.id === courseId);
            const index = selectedCourses.findIndex(c => c.id === courseId);
            
            if (index === -1) {
                selectedCourses.push(course);
            } else {
                selectedCourses.splice(index, 1);
            }
            
            renderCourses();
            renderSelectedCourses();
            updateStats();
        }

        // ìµœì í™” ì„¤ì •
        const OPTIMAL_GAP_TIME = 1; // ê°•ì˜ ì‚¬ì´ ì‹œê°„ (êµì‹œ) - 1ìˆœìœ„
        const MAX_CONTINUOUS_TIME = 4; // ìµœëŒ€ ì—°ê°•ì‹œê°„ (êµì‹œ) - 2ìˆœìœ„
        
        // 18í•™ì  ìë™ ì„ íƒ (í˜„ì‹¤ì ì¸ ìµœì í™”)
        function autoSelectOptimal() {
            selectedCourses = [];
            
            // 1ë‹¨ê³„: ì „ê³µí•„ìˆ˜ ê³¼ëª© ìš°ì„  ì„ íƒ
            const required = courses.filter(c => c.isRequired);
            selectedCourses = [...required];
            
            // 2ë‹¨ê³„: í˜„ì‹¤ì ì¸ ìµœì í™” ì•Œê³ ë¦¬ì¦˜
            const allCourses = courses.filter(c => !c.isRequired);
            let bestScore = -1;
            let bestCombination = [...selectedCourses];
            
            // ê°•ì˜ê°„ê²© ìµœìš°ì„  ë°±íŠ¸ë˜í‚¹ (3êµì‹œ ì´ìƒ ê°„ê²© ì™„ì „ ì œê±°)
            function findGapOptimizedCombination(currentCourses, remainingCourses, targetCredits, maxIterations = 5000) {
                let iterations = 0;
                let foundValidCombination = false;
                
                function explore(currentCourses, remainingCourses, targetCredits) {
                    iterations++;
                    if (iterations > maxIterations) return; // ì„±ëŠ¥ ì œí•œ
                    
                    const currentCredits = getTotalCredits(currentCourses);
                    
                    // ëª©í‘œ í•™ì  ë‹¬ì„± ì‹œ ê°•ì˜ê°„ê²©ë§Œ í‰ê°€
                    if (currentCredits >= targetCredits) {
                        const gapScore = calculateGapOnlyScore(currentCourses);
                        
                        // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ì—†ëŠ” ì¡°í•©ë§Œ ê³ ë ¤
                        if (gapScore > -999999) {
                            foundValidCombination = true;
                            if (gapScore > bestScore) {
                                bestScore = gapScore;
                                bestCombination = [...currentCourses];
                            }
                        }
                        return;
                    }
                    
                    // ë‚¨ì€ ê³¼ëª©ì´ ì—†ìœ¼ë©´ ì¢…ë£Œ
                    if (remainingCourses.length === 0) return;
                    
                    // í˜„ì¬ ì¡°í•©ì´ ëª©í‘œ í•™ì ì„ ì´ˆê³¼í•˜ë©´ ì¢…ë£Œ
                    if (currentCredits > targetCredits) return;
                    
                    // ê°•ì˜ê°„ê²© ìµœìš°ì„ ìœ¼ë¡œ ê³¼ëª© ì •ë ¬
                    const gapOptimizedCourses = sortCoursesForGapOptimization(remainingCourses, currentCourses);
                    
                    // ëª¨ë“  ê³¼ëª©ì„ ê³ ë ¤í•˜ë˜, ê°•ì˜ê°„ê²©ì´ ì¢‹ì€ ìˆœì„œë¡œ íƒìƒ‰
                    for (let i = 0; i < gapOptimizedCourses.length; i++) {
                        const course = gapOptimizedCourses[i];
                        const newCourses = [...currentCourses, course];
                        
                        // ì¶©ëŒ ì²´í¬ ë° í•™ì  ì œí•œ
                        if (checkConflicts(newCourses).length === 0 && getTotalCredits(newCourses) <= 21) {
                            const newRemaining = remainingCourses.filter(c => c !== course);
                            explore(newCourses, newRemaining, targetCredits);
                        }
                    }
                }
                
                explore(currentCourses, remainingCourses, targetCredits);
                
                // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ì—†ëŠ” ì¡°í•©ì„ ì°¾ì§€ ëª»í–ˆë‹¤ë©´ ê²½ê³ 
                if (!foundValidCombination) {
                    console.warn('3êµì‹œ ì´ìƒ ê°„ê²©ì´ ì—†ëŠ” 18í•™ì  ì¡°í•©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë” ë§ì€ ê³¼ëª© ë°ì´í„°ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                }
            }
            
            findGapOptimizedCombination(selectedCourses, allCourses, 18);
            selectedCourses = bestCombination;
            
            renderCourses();
            renderSelectedCourses();
            updateStats();
            
            // ìµœì í™” ì™„ë£Œ í›„ ì¦‰ì‹œ ì‹œê°„í‘œ ìƒì„± (ì•Œë¦¼ ì—†ì´)
            if (selectedCourses.length > 0) {
                generateTimetable(true);
            }
        }
        
        // ê°•ì˜ê°„ê²© ìµœìš°ì„  ê³¼ëª© ì •ë ¬
        function sortCoursesForGapOptimization(remainingCourses, currentCourses) {
            return remainingCourses.sort((a, b) => {
                const scoreA = calculateGapOptimizedScore(a, currentCourses);
                const scoreB = calculateGapOptimizedScore(b, currentCourses);
                return scoreB - scoreA;
            });
        }
        
        // ê°•ì˜ê°„ê²© ìµœìš°ì„  ì ìˆ˜ ê³„ì‚°
        function calculateGapOptimizedScore(course, currentCourses) {
            // ìš°ì„ ìˆœìœ„ëŠ” ë¬´ì‹œí•˜ê³  ê°•ì˜ê°„ê²©ë§Œ ê³ ë ¤
            let score = 0;
            
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            course.timeSlots.forEach(slot => {
                const dayIndex = days.indexOf(slot.day);
                const timeIndex = timeSlots.indexOf(slot.startTime);
                
                if (dayIndex !== -1 && timeIndex !== -1) {
                    // ê°•ì˜ê°„ê²© ë¶„ì„ (ì ˆëŒ€ ìš°ì„ !)
                    const gapBefore = analyzeGapBefore(currentCourses, course, dayIndex, timeIndex);
                    const gapAfter = analyzeGapAfter(currentCourses, course, dayIndex, timeIndex);
                    
                    // ê°•ì˜ê°„ê²©ë§Œìœ¼ë¡œ ì ìˆ˜ ê³„ì‚° (ìš°ì„ ìˆœìœ„ ë¬´ì‹œ)
                    if (gapBefore === 1 || gapAfter === 1) {
                        score += 2000; // 1êµì‹œ ê°„ê²© (ì ˆëŒ€ ìµœê³ !)
                    } else if (gapBefore === 0 || gapAfter === 0) {
                        score += 1000; // ì—°ê°• (ì¢‹ìŒ)
                    } else if (gapBefore === 2 || gapAfter === 2) {
                        score += 300; // 2êµì‹œ ê°„ê²© (í—ˆìš©)
                    } else if (gapBefore === 3 || gapAfter === 3) {
                        score += 100; // 3êµì‹œ ê°„ê²© (ìµœì†Œ)
                    } else if (gapBefore >= 4 || gapAfter >= 4) {
                        score -= 500; // 4êµì‹œ ì´ìƒ ê°„ê²© (ê°•í•œ ê°ì )
                    }
                    
                    // ì—°ê°•ì‹œê°„ ì œí•œ
                    const continuousTime = calculateContinuousTimeForCourse(currentCourses, course, dayIndex, timeIndex);
                    if (continuousTime > MAX_CONTINUOUS_TIME) {
                        score -= 1000; // ì—°ê°•ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•í•œ ê°ì 
                    }
                }
            });
            
            return score;
        }
        
        // ê°•ì˜ê°„ê²©ë§Œì„ ìœ„í•œ ì¡°í•© ì ìˆ˜ ê³„ì‚° (3êµì‹œ ì´ìƒ ê°„ê²© ì™„ì „ ì œê±°)
        function calculateGapOnlyScore(courses) {
            // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ìˆìœ¼ë©´ ì•„ì˜ˆ 0ì  (ì™„ì „ ì œê±°)
            if (hasLongGaps(courses)) {
                return -999999; // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ìˆìœ¼ë©´ ì™„ì „ ë°°ì œ
            }
            
            let totalScore = 0;
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            // ëª¨ë“  ê³¼ëª©ì˜ ëª¨ë“  ì‹œê°„ëŒ€ì— ëŒ€í•´ ê°•ì˜ê°„ê²© ë¶„ì„
            courses.forEach(course => {
                course.timeSlots.forEach(slot => {
                    const dayIndex = days.indexOf(slot.day);
                    const timeIndex = timeSlots.indexOf(slot.startTime);
                    
                    if (dayIndex !== -1 && timeIndex !== -1) {
                        const gapBefore = analyzeGapBefore(courses, course, dayIndex, timeIndex);
                        const gapAfter = analyzeGapAfter(courses, course, dayIndex, timeIndex);
                        
                        // ê°•ì˜ê°„ê²© ì ìˆ˜ (3êµì‹œ ì´ìƒ ê°„ê²©ì€ ì´ë¯¸ ì œì™¸ë¨)
                        if (gapBefore === 1 || gapAfter === 1) {
                            totalScore += 1000; // 1êµì‹œ ê°„ê²© (ìµœê³ )
                        } else if (gapBefore === 0 || gapAfter === 0) {
                            totalScore += 500; // ì—°ê°• (ì¢‹ìŒ)
                        } else if (gapBefore === 2 || gapAfter === 2) {
                            totalScore += 200; // 2êµì‹œ ê°„ê²© (í—ˆìš©)
                        }
                        
                        // ì—°ê°•ì‹œê°„ ì œí•œ
                        const continuousTime = calculateContinuousTimeForCourse(courses, course, dayIndex, timeIndex);
                        if (continuousTime > MAX_CONTINUOUS_TIME) {
                            totalScore -= 1000; // ì—°ê°•ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•í•œ ê°ì 
                        }
                    }
                });
            });
            
            return totalScore;
        }
        
        // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ìˆëŠ”ì§€ í™•ì¸
        function hasLongGaps(courses) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            for (let course of courses) {
                for (let slot of course.timeSlots) {
                    const dayIndex = days.indexOf(slot.day);
                    const timeIndex = timeSlots.indexOf(slot.startTime);
                    
                    if (dayIndex !== -1 && timeIndex !== -1) {
                        const gapBefore = analyzeGapBefore(courses, course, dayIndex, timeIndex);
                        const gapAfter = analyzeGapAfter(courses, course, dayIndex, timeIndex);
                        
                        // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ìˆìœ¼ë©´ true ë°˜í™˜
                        if (gapBefore >= 3 || gapAfter >= 3) {
                            return true;
                        }
                    }
                }
            }
            
            return false; // 3êµì‹œ ì´ìƒ ê°„ê²©ì´ ì—†ìŒ
        }
        
        // ê°•ì˜ê°„ê²© ìµœìš°ì„  ê³¼ëª© ì ìˆ˜ ê³„ì‚°
        function calculateRealisticCourseScore(course, currentCourses) {
            // ìš°ì„ ìˆœìœ„ëŠ” ìµœì†Œí™”í•˜ê³  ê°•ì˜ê°„ê²©ì„ ìµœìš°ì„ ìœ¼ë¡œ
            let score = course.priority * 2; // ê¸°ë³¸ ìš°ì„ ìˆœìœ„ ì ìˆ˜ë¥¼ í¬ê²Œ ì¤„ì„
            
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            course.timeSlots.forEach(slot => {
                const dayIndex = days.indexOf(slot.day);
                const timeIndex = timeSlots.indexOf(slot.startTime);
                
                if (dayIndex !== -1 && timeIndex !== -1) {
                    // ê°•ì˜ê°„ê²© ë¶„ì„ (ê°€ì¥ ì¤‘ìš”!)
                    const gapBefore = analyzeGapBefore(currentCourses, course, dayIndex, timeIndex);
                    const gapAfter = analyzeGapAfter(currentCourses, course, dayIndex, timeIndex);
                    
                    // ê°•ì˜ê°„ê²©ì„ ìµœìš°ì„ ìœ¼ë¡œ ì ìˆ˜ ê³„ì‚°
                    if (gapBefore === 1 || gapAfter === 1) {
                        score += 1000; // 1êµì‹œ ê°„ê²© (ìµœê³  ìš°ì„ !)
                    } else if (gapBefore === 0 || gapAfter === 0) {
                        score += 500; // ì—°ê°• (ì¢‹ìŒ)
                    } else if (gapBefore === 2 || gapAfter === 2) {
                        score += 200; // 2êµì‹œ ê°„ê²© (í—ˆìš©)
                    } else if (gapBefore === 3 || gapAfter === 3) {
                        score += 50; // 3êµì‹œ ê°„ê²© (ìµœì†Œ ì ìˆ˜)
                    } else if (gapBefore >= 4 || gapAfter >= 4) {
                        score -= 200; // 4êµì‹œ ì´ìƒ ê°„ê²© (ê°•í•œ ê°ì )
                    }
                    
                    // ì—°ê°•ì‹œê°„ ì œí•œ (2ìˆœìœ„)
                    const continuousTime = calculateContinuousTimeForCourse(currentCourses, course, dayIndex, timeIndex);
                    if (continuousTime > MAX_CONTINUOUS_TIME) {
                        score -= 500; // ì—°ê°•ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•í•œ ê°ì 
                    }
                }
            });
            
            return score;
        }
        
        // ê³µê°• ìµœì í™”ë¥¼ ìœ„í•œ ê³¼ëª© ì •ë ¬
        function sortCoursesForOptimalGaps(remainingCourses, currentCourses) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            return remainingCourses.sort((a, b) => {
                // ê° ê³¼ëª©ì˜ ê³µê°• ìµœì í™” ì ìˆ˜ ê³„ì‚°
                const scoreA = calculateCourseGapScore(a, currentCourses);
                const scoreB = calculateCourseGapScore(b, currentCourses);
                
                return scoreB - scoreA; // ë†’ì€ ì ìˆ˜ë¶€í„°
            });
        }
        
        // ê³¼ëª©ë³„ ê°•ì˜ ê°„ê²© ìµœì í™” ì ìˆ˜ ê³„ì‚°
        function calculateCourseGapScore(course, currentCourses) {
            let score = course.priority * 10; // ê¸°ë³¸ ìš°ì„ ìˆœìœ„ ì ìˆ˜
            
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            
            // ê° ì‹œê°„ëŒ€ë³„ë¡œ ê°•ì˜ ê°„ê²© ìµœì í™” ì ìˆ˜ ê³„ì‚°
            course.timeSlots.forEach(slot => {
                const dayIndex = days.indexOf(slot.day);
                const timeIndex = timeSlots.indexOf(slot.startTime);
                
                if (dayIndex !== -1 && timeIndex !== -1) {
                    // ê°•ì˜ ê°„ê²© ë¶„ì„
                    const gapBefore = analyzeGapBefore(currentCourses, course, dayIndex, timeIndex);
                    const gapAfter = analyzeGapAfter(currentCourses, course, dayIndex, timeIndex);
                    
                    // 1ìˆœìœ„: ê°•ì˜ ì‚¬ì´ ì‹œê°„ì´ 1êµì‹œ(1ì‹œê°„)ì´ì–´ì•¼ í•¨ (í•˜ì§€ë§Œ í˜„ì‹¤ì ìœ¼ë¡œëŠ” ì–´ë ¤ì›€)
                    if (gapBefore === OPTIMAL_GAP_TIME || gapAfter === OPTIMAL_GAP_TIME) {
                        score += 300; // ìµœê³  ì ìˆ˜
                    } else if (gapBefore === 0 || gapAfter === 0) {
                        score += 200; // ì—°ê°•ë„ ê´œì°®ìŒ
                    } else if (gapBefore === 2 || gapAfter === 2) {
                        score += 100; // 2êµì‹œ ê°„ê²©ë„ í—ˆìš©
                    } else if (gapBefore === 3 || gapAfter === 3) {
                        score += 50; // 3êµì‹œ ê°„ê²©ë„ ë¶€ë¶„ ì ìˆ˜
                    } else if (gapBefore >= 4 || gapAfter >= 4) {
                        score -= 50; // 4êµì‹œ ì´ìƒ ê°„ê²©ë§Œ ê°ì 
                    }
                    
                    // 2ìˆœìœ„: ì—°ê°•ì‹œê°„ì´ 4ì‹œê°„ì„ ë„˜ìœ¼ë©´ ì•ˆë¨
                    const continuousTime = calculateContinuousTimeForCourse(currentCourses, course, dayIndex, timeIndex);
                    if (continuousTime > MAX_CONTINUOUS_TIME) {
                        score -= 150; // ì—°ê°•ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•í•œ ê°ì 
                    }
                }
            });
            
            return score;
        }
        
        // ê°•ì˜ ì´ì „ ê°„ê²© ë¶„ì„
        function analyzeGapBefore(currentCourses, newCourse, dayIndex, timeIndex) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            const day = days[dayIndex];
            
            // ì„ì‹œë¡œ ê³¼ëª© ì¶”ê°€
            const tempCourses = [...currentCourses, newCourse];
            
            let gapCount = 0;
            
            // í•´ë‹¹ ì‹œê°„ ì´ì „ì˜ ê³µê°• ê³„ì‚°
            for (let i = timeIndex - 1; i >= 0; i--) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (!hasClass) {
                    gapCount++;
                } else {
                    break; // ë°”ë¡œ ì´ì „ ê°•ì˜ê¹Œì§€ì˜ ê°„ê²©ë§Œ ê³„ì‚°
                }
            }
            
            return gapCount;
        }
        
        // ê°•ì˜ ì´í›„ ê°„ê²© ë¶„ì„
        function analyzeGapAfter(currentCourses, newCourse, dayIndex, timeIndex) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            const day = days[dayIndex];
            
            // ì„ì‹œë¡œ ê³¼ëª© ì¶”ê°€
            const tempCourses = [...currentCourses, newCourse];
            
            let gapCount = 0;
            
            // í•´ë‹¹ ì‹œê°„ ì´í›„ì˜ ê³µê°• ê³„ì‚°
            for (let i = timeIndex + 1; i < timeSlots.length; i++) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (!hasClass) {
                    gapCount++;
                } else {
                    break; // ë°”ë¡œ ë‹¤ìŒ ê°•ì˜ê¹Œì§€ì˜ ê°„ê²©ë§Œ ê³„ì‚°
                }
            }
            
            return gapCount;
        }
        
        // íŠ¹ì • ê³¼ëª©ì˜ ì—°ê°•ì‹œê°„ ê³„ì‚°
        function calculateContinuousTimeForCourse(currentCourses, newCourse, dayIndex, timeIndex) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            const day = days[dayIndex];
            
            const tempCourses = [...currentCourses, newCourse];
            
            let continuousCount = 1; // í˜„ì¬ ê³¼ëª© í¬í•¨
            
            // ì•ìª½ ì—°ê°• ê³„ì‚°
            for (let i = timeIndex - 1; i >= 0; i--) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (hasClass) {
                    continuousCount++;
                } else {
                    break;
                }
            }
            
            // ë’¤ìª½ ì—°ê°• ê³„ì‚°
            for (let i = timeIndex + 1; i < timeSlots.length; i++) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (hasClass) {
                    continuousCount++;
                } else {
                    break;
                }
            }
            
            return continuousCount;
        }
        
        // ì—°ê°• ì ìˆ˜ ê³„ì‚°
        function calculateContinuousScore(currentCourses, newCourse, dayIndex, timeIndex) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            const day = days[dayIndex];
            
            const tempCourses = [...currentCourses, newCourse];
            
            let continuousCount = 1; // í˜„ì¬ ê³¼ëª© í¬í•¨
            
            // ì•ìª½ ì—°ê°• ê³„ì‚°
            for (let i = timeIndex - 1; i >= 0; i--) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (hasClass) {
                    continuousCount++;
                } else {
                    break;
                }
            }
            
            // ë’¤ìª½ ì—°ê°• ê³„ì‚°
            for (let i = timeIndex + 1; i < timeSlots.length; i++) {
                const hasClass = tempCourses.some(course => 
                    course.timeSlots.some(slot => 
                        slot.day === day && slot.startTime === timeSlots[i]
                    )
                );
                if (hasClass) {
                    continuousCount++;
                } else {
                    break;
                }
            }
            
            // ìµœì  ì—°ê°•ì‹œê°„(4êµì‹œ)ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë†’ì€ ì ìˆ˜
            if (continuousCount === OPTIMAL_CONTINUOUS_TIME) {
                return 150; // ìµœì  ì—°ê°•ì‹œê°„ ë³´ë„ˆìŠ¤
            } else if (continuousCount > 0) {
                return Math.max(0, 100 - Math.abs(continuousCount - OPTIMAL_CONTINUOUS_TIME) * 25);
            }
            
            return 0;
        }
        
        // ì‹œê°„í‘œ ì ìˆ˜ ê³„ì‚° (ê³µê°•ê³¼ ì—°ê°• ìµœì í™”)
        function calculateScheduleScore(courses) {
            let score = 0;
            
            // ê¸°ë³¸ ì ìˆ˜
            score += 1000;
            
            // ì¶©ëŒ ê°ì 
            const conflicts = checkConflicts(courses);
            score -= conflicts.length * 200;
            
            // í•™ì  ì ìˆ˜
            const credits = getTotalCredits(courses);
            if (credits === 18) {
                score += 500; // ì •í™•íˆ 18í•™ì ì´ë©´ ë³´ë„ˆìŠ¤
            } else {
                score -= Math.abs(credits - 18) * 50; // 18í•™ì ì—ì„œ ë²—ì–´ë‚˜ë©´ ê°ì 
            }
            
            // ê³µê°• ì‹œê°„ ìµœì í™” ì ìˆ˜
            const freeTimeScore = calculateFreeTimeScore(courses);
            score += freeTimeScore;
            
            // ì—°ê°• ì‹œê°„ ìµœì í™” ì ìˆ˜
            const continuousTimeScore = calculateContinuousTimeScore(courses);
            score += continuousTimeScore;
            
            // ê³¼ëª© ìš°ì„ ìˆœìœ„ ì ìˆ˜
            const priorityScore = courses.reduce((sum, course) => sum + course.priority * 10, 0);
            score += priorityScore;
            
            // í•„ìˆ˜ ê³¼ëª© ë³´ë„ˆìŠ¤
            const requiredCount = courses.filter(c => c.isRequired).length;
            score += requiredCount * 100;
            
            return score;
        }
        
        // ê°•ì˜ ê°„ê²© ìµœì í™” ì ìˆ˜ ê³„ì‚°
        function calculateFreeTimeScore(courses) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            let totalGapScore = 0;
            
            days.forEach(day => {
                const daySchedule = [];
                
                // í•´ë‹¹ ìš”ì¼ì˜ ìˆ˜ì—… ì‹œê°„ ì²´í¬
                timeSlots.forEach(time => {
                    const hasClass = courses.some(course => 
                        course.timeSlots.some(slot => 
                            slot.day === day && slot.startTime === time
                        )
                    );
                    daySchedule.push(hasClass);
                });
                
                // ê°•ì˜ ê°„ê²© ë¶„ì„
                let gapScore = 0;
                
                for (let i = 0; i < daySchedule.length - 1; i++) {
                    if (daySchedule[i] && !daySchedule[i + 1]) {
                        // ê°•ì˜ í›„ ê³µê°• ì‹œì‘
                        let gapLength = 1;
                        for (let j = i + 2; j < daySchedule.length; j++) {
                            if (!daySchedule[j]) {
                                gapLength++;
                            } else {
                                break;
                            }
                        }
                        
                        // ê°•ì˜ ê°„ê²© ì ìˆ˜ ê³„ì‚° (1ìˆœìœ„)
                        if (gapLength === OPTIMAL_GAP_TIME) {
                            gapScore += 300; // ìµœì  ê°„ê²©(1êµì‹œ) ë³´ë„ˆìŠ¤
                        } else if (gapLength === 0) {
                            gapScore += 200; // ì—°ê°•
                        } else if (gapLength === 2) {
                            gapScore += 100; // 2êµì‹œ ê°„ê²© í—ˆìš©
                        } else if (gapLength === 3) {
                            gapScore += 50; // 3êµì‹œ ê°„ê²©ë„ ë¶€ë¶„ ì ìˆ˜
                        } else if (gapLength >= 4) {
                            gapScore -= 50; // 4êµì‹œ ì´ìƒ ê°„ê²©ë§Œ ê°ì 
                        }
                    }
                }
                
                totalGapScore += gapScore;
            });
            
            return totalGapScore;
        }
        
        // ì—°ê°• ì‹œê°„ ìµœì í™” ì ìˆ˜ ê³„ì‚° (2ìˆœìœ„)
        function calculateContinuousTimeScore(courses) {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            let totalContinuousScore = 0;
            
            days.forEach(day => {
                const daySchedule = [];
                
                // í•´ë‹¹ ìš”ì¼ì˜ ìˆ˜ì—… ì‹œê°„ ì²´í¬
                timeSlots.forEach(time => {
                    const hasClass = courses.some(course => 
                        course.timeSlots.some(slot => 
                            slot.day === day && slot.startTime === time
                        )
                    );
                    daySchedule.push(hasClass);
                });
                
                // ì—°ê°• ì‹œê°„ íŒ¨í„´ ë¶„ì„
                let consecutiveClass = 0;
                let continuousScore = 0;
                
                for (let i = 0; i < daySchedule.length; i++) {
                    if (daySchedule[i]) {
                        consecutiveClass++;
                    } else {
                        if (consecutiveClass > 0) {
                            // 2ìˆœìœ„: ì—°ê°•ì‹œê°„ì´ 4ì‹œê°„ì„ ë„˜ìœ¼ë©´ ì•ˆë¨
                            if (consecutiveClass <= MAX_CONTINUOUS_TIME) {
                                continuousScore += 100; // í—ˆìš© ë²”ìœ„ ë‚´ ì—°ê°•
                            } else {
                                continuousScore -= 150; // 4ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•í•œ ê°ì 
                            }
                        }
                        consecutiveClass = 0;
                    }
                }
                
                // í•˜ë£¨ ëì˜ ì—°ê°• ì‹œê°„ë„ ê³„ì‚°
                if (consecutiveClass > 0) {
                    if (consecutiveClass <= MAX_CONTINUOUS_TIME) {
                        continuousScore += 100;
                    } else {
                        continuousScore -= 150;
                    }
                }
                
                totalContinuousScore += continuousScore;
            });
            
            return totalContinuousScore;
        }

        // ì´ í•™ì  ê³„ì‚°
        function getTotalCredits() {
            return selectedCourses.reduce((sum, course) => sum + course.credit, 0);
        }

        // ê³µê°• ì‹œê°„ ê³„ì‚° (ì—°ì†ëœ ê³µê°• ì‹œê°„ ë¶„ì„)
        function calculateFreeTime() {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            let totalFreeTime = 0;
            
            days.forEach(day => {
                let consecutiveFree = 0;
                
                timeSlots.forEach(time => {
                    const hasClass = findCourseAtTime(day, time);
                    
                    if (!hasClass) {
                        consecutiveFree++;
                    } else {
                        if (consecutiveFree > 0) {
                            // ì—°ì†ëœ ê³µê°• ì‹œê°„ì„ ê³„ì‚°
                            totalFreeTime += consecutiveFree;
                        }
                        consecutiveFree = 0;
                    }
                });
                
                // í•˜ë£¨ ëì˜ ê³µê°• ì‹œê°„ë„ ê³„ì‚°
                if (consecutiveFree > 0) {
                    totalFreeTime += consecutiveFree;
                }
            });
            
            return totalFreeTime;
        }
        
        // ê°•ì˜ ê°„ê²© ë¶„ì„ (ìƒì„¸ ì •ë³´)
        function analyzeFreeTime() {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            const gapAnalysis = [];
            
            days.forEach(day => {
                const daySchedule = [];
                
                // í•´ë‹¹ ìš”ì¼ì˜ ìˆ˜ì—… ì‹œê°„ ì²´í¬
                timeSlots.forEach(time => {
                    const hasClass = findCourseAtTime(day, time);
                    daySchedule.push(hasClass);
                });
                
                // ê°•ì˜ ê°„ê²© ë¶„ì„
                for (let i = 0; i < daySchedule.length - 1; i++) {
                    if (daySchedule[i] && !daySchedule[i + 1]) {
                        // ê°•ì˜ í›„ ê³µê°• ì‹œì‘
                        let gapLength = 1;
                        let endIndex = i + 1;
                        
                        for (let j = i + 2; j < daySchedule.length; j++) {
                            if (!daySchedule[j]) {
                                gapLength++;
                                endIndex = j;
                            } else {
                                break;
                            }
                        }
                        
                        gapAnalysis.push({
                            day,
                            startTime: timeSlots[i],
                            gapStartTime: timeSlots[i + 1],
                            gapEndTime: timeSlots[endIndex],
                            duration: gapLength,
                            isOptimal: gapLength === OPTIMAL_GAP_TIME,
                            isTooLong: gapLength >= 3
                        });
                    }
                }
            });
            
            return gapAnalysis;
        }

        // ê³¼ëª© ëª©ë¡ ë Œë”ë§
        function renderCourses() {
            const courseList = document.getElementById('courseList');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            filteredCourses = courses.filter(course => {
                const matchesSearch = course.name.toLowerCase().includes(searchTerm) ||
                                     course.code.toLowerCase().includes(searchTerm) ||
                                     course.professor.toLowerCase().includes(searchTerm);
                
                const matchesFilter = currentFilter === 'all' || course.category === currentFilter;
                
                return matchesSearch && matchesFilter;
            });

            courseList.innerHTML = filteredCourses.map(course => {
                const isSelected = selectedCourses.some(c => c.id === course.id);
                const categoryColor = {
                    'required': 'bg-red-100 text-red-800 border-red-200',
                    'elective': 'bg-blue-100 text-blue-800 border-blue-200',
                    'general': 'bg-yellow-100 text-yellow-800 border-yellow-200'
                };
                
                return `
                    <div class="course-card p-3 border rounded-lg cursor-pointer ${isSelected ? 'selected' : ''}"
                         onclick="toggleCourse('${course.id}')">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center mb-1">
                                    <h4 class="font-medium">${course.name}</h4>
                                    <span class="ml-2 px-2 py-1 text-xs rounded-full border ${categoryColor[course.category]}">
                                        ${course.category === 'required' ? 'ì „í•„' : course.category === 'elective' ? 'ì „ì„ ' : 'êµì–‘'}
                                    </span>
                                </div>
                                <div class="text-sm text-gray-600 mb-2">
                                    ${course.code} â€¢ ${course.professor} â€¢ ${course.credit}í•™ì 
                                </div>
                                <div class="space-y-1">
                                    ${course.timeSlots.map(slot => `
                                        <div class="text-xs text-gray-500">
                                            ğŸ• ${slot.day} ${slot.startTime}-${slot.endTime} ğŸ“ ${slot.room}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-600 mb-2">
                                    â­ ${course.priority}
                                </div>
                                <div class="w-4 h-4 rounded border-2 ${isSelected ? 'bg-blue-600 border-blue-600' : 'border-gray-300'}">
                                    ${isSelected ? '<div class="w-full h-full flex items-center justify-center"><div class="w-2 h-2 bg-white rounded-full"></div></div>' : ''}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('filteredCount').textContent = filteredCourses.length;
        }

        // ì„ íƒëœ ê³¼ëª© ëª©ë¡ ë Œë”ë§
        function renderSelectedCourses() {
            const selectedList = document.getElementById('selectedCoursesList');
            selectedList.innerHTML = selectedCourses.map(course => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <div>
                        <span class="font-medium">${course.name}</span>
                        <span class="text-sm text-gray-500 ml-2">
                            (${course.code}) - ${course.professor} - ${course.credit}í•™ì 
                        </span>
                    </div>
                    <span class="text-sm text-blue-600">
                        ìš°ì„ ìˆœìœ„: ${course.priority}
                    </span>
                </div>
            `).join('');
        }

        // ì—°ê°• ì‹œê°„ ê³„ì‚°
        function calculateContinuousTime() {
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            const timeSlots = ['09:00', '10:30', '12:00', '13:30', '15:00', '16:30', '18:00'];
            let totalContinuousTime = 0;
            
            days.forEach(day => {
                const daySchedule = [];
                
                // í•´ë‹¹ ìš”ì¼ì˜ ìˆ˜ì—… ì‹œê°„ ì²´í¬
                timeSlots.forEach(time => {
                    const hasClass = selectedCourses.some(course => 
                        course.timeSlots.some(slot => 
                            slot.day === day && slot.startTime === time
                        )
                    );
                    daySchedule.push(hasClass);
                });
                
                // ì—°ê°• ì‹œê°„ ê³„ì‚°
                let consecutiveClass = 0;
                let maxConsecutive = 0;
                
                for (let i = 0; i < daySchedule.length; i++) {
                    if (daySchedule[i]) {
                        consecutiveClass++;
                        maxConsecutive = Math.max(maxConsecutive, consecutiveClass);
                    } else {
                        consecutiveClass = 0;
                    }
                }
                
                totalContinuousTime += maxConsecutive;
            });
            
            return totalContinuousTime;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            const totalCredits = getTotalCredits();
            const freeTime = calculateFreeTime();
            const continuousTime = calculateContinuousTime();
            const scheduleScore = selectedCourses.length > 0 ? calculateScheduleScore(selectedCourses) : 0;
            
            document.getElementById('totalCourses').textContent = courses.length;
            document.getElementById('selectedCourses').textContent = selectedCourses.length;
            document.getElementById('totalCredits').textContent = totalCredits;
            document.getElementById('totalCredits2').textContent = totalCredits;
            document.getElementById('selectedCount').textContent = selectedCourses.length;
            document.getElementById('freeTime').textContent = freeTime;
            document.getElementById('continuousTime').textContent = continuousTime;
            document.getElementById('scheduleScore').textContent = Math.round(scheduleScore);
            document.getElementById('currentScore').textContent = Math.round(scheduleScore);
            
            document.getElementById('generateBtn').disabled = selectedCourses.length === 0;
        }

        // ì‹œê°„í‘œ ìƒì„±
        function generateTimetable(skipAlert = false) {
            if (selectedCourses.length === 0) {
                if (!skipAlert) {
                    alert('ìµœì†Œ í•˜ë‚˜ ì´ìƒì˜ ê³¼ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                }
                return;
            }

            // ì¶©ëŒ ê²€ì‚¬
            const conflicts = checkConflicts(selectedCourses);
            
            if (conflicts.length > 0) {
                if (!skipAlert) {
                    alert(`ì‹œê°„ ì¶©ëŒì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n${conflicts.map(c => c.courses.map(course => course.name).join(', ')).join('\n')}`);
                }
                return;
            }

            // ì‹œê°„í‘œ í‘œì‹œ
            document.getElementById('timetableSection').style.display = 'block';
            createTimetableGrid();
            
            // ìµœì í™” ì •ë³´ ìˆ˜ì§‘
            const totalCredits = getTotalCredits();
            const freeTime = calculateFreeTime();
            const continuousTime = calculateContinuousTime();
            const scheduleScore = calculateScheduleScore(selectedCourses);
            
            // ìµœì í™” ë¶„ì„
            const freeTimeScore = calculateFreeTimeScore(selectedCourses);
            const continuousTimeScore = calculateContinuousTimeScore(selectedCourses);
            
            // ê°•ì˜ ê°„ê²© ìƒì„¸ ë¶„ì„
            const gapAnalysis = analyzeFreeTime();
            const optimalGaps = gapAnalysis.filter(gap => gap.isOptimal).length;
            const longGaps = gapAnalysis.filter(gap => gap.isTooLong).length;
            
            // ìƒì„¸ ì •ë³´ í‘œì‹œ
            const message = `
ì‹œê°„í‘œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

ğŸ“Š ê¸°ë³¸ ì •ë³´:
â€¢ ì´ í•™ì : ${totalCredits}í•™ì 
â€¢ ì„ íƒëœ ê³¼ëª©: ${selectedCourses.length}ê°œ
â€¢ ì‹œê°„ ì¶©ëŒ: ${conflicts.length}ê°œ

â° ì‹œê°„ ìµœì í™”:
â€¢ ì´ ê³µê°• ì‹œê°„: ${freeTime}ê°œ êµì‹œ
â€¢ ìµœì  ê°•ì˜ê°„ê²©(1êµì‹œ): ${optimalGaps}ê°œ âœ…
â€¢ ê¸´ ê°•ì˜ê°„ê²©(3êµì‹œ ì´ìƒ): ${longGaps}ê°œ âš ï¸
â€¢ ì—°ê°• ì‹œê°„: ${continuousTime}ê°œ êµì‹œ
â€¢ ê°•ì˜ê°„ê²© ìµœì í™” ì ìˆ˜: ${Math.round(freeTimeScore)}ì 
â€¢ ì—°ê°•ì‹œê°„ ìµœì í™” ì ìˆ˜: ${Math.round(continuousTimeScore)}ì 

ğŸ¯ ì¢…í•© ìµœì í™” ì ìˆ˜: ${Math.round(scheduleScore)}ì 

${totalCredits === 18 ? 'âœ… ëª©í‘œ í•™ì (18í•™ì ) ë‹¬ì„±!' : `âš ï¸ ëª©í‘œ í•™ì ê³¼ ${Math.abs(18 - totalCredits)}í•™ì  ì°¨ì´`}
${optimalGaps > 0 ? `âœ… ìµœì  ê°•ì˜ê°„ê²©(1êµì‹œ) ${optimalGaps}ê°œ ë‹¬ì„±!` : 'âš ï¸ ìµœì  ê°•ì˜ê°„ê²© ë¶€ì¡±'}
${longGaps === 0 ? `âœ… ê¸´ ê°•ì˜ê°„ê²©(3êµì‹œ ì´ìƒ) 0ê°œ (ì™„ë²½í•œ ìµœì í™”!)` : `âŒ ê¸´ ê°•ì˜ê°„ê²©(3êµì‹œ ì´ìƒ) ${longGaps}ê°œ ì¡´ì¬ (ìµœì í™” ì‹¤íŒ¨)`}
${continuousTimeScore > 0 ? 'âœ… ì—°ê°•ì‹œê°„ ì œí•œ ì¤€ìˆ˜!' : 'âš ï¸ ì—°ê°•ì‹œê°„ ì œí•œ ìœ„ë°˜'}

ğŸ“‹ ê°•ì˜ ê°„ê²© ìƒì„¸:
${gapAnalysis.map(gap => 
  `â€¢ ${gap.day}ìš”ì¼ ${gap.startTime} í›„ ${gap.gapStartTime}-${gap.gapEndTime} (${gap.duration}êµì‹œ ê°„ê²©) ${gap.isOptimal ? 'âœ…' : gap.isTooLong ? 'âš ï¸' : 'ğŸ”¸'}`
).join('\n')}
            `;
            
            alert(message);
        }

        // ì¶©ëŒ ê²€ì‚¬
        function checkConflicts(courses) {
            const conflicts = [];
            
            for (let i = 0; i < courses.length; i++) {
                for (let j = i + 1; j < courses.length; j++) {
                    const course1 = courses[i];
                    const course2 = courses[j];
                    
                    for (const slot1 of course1.timeSlots) {
                        for (const slot2 of course2.timeSlots) {
                            if (slot1.day === slot2.day && 
                                slot1.startTime === slot2.startTime && 
                                slot1.endTime === slot2.endTime) {
                                conflicts.push({
                                    courses: [course1, course2],
                                    timeSlot: slot1
                                });
                            }
                        }
                    }
                }
            }
            
            return conflicts;
        }

        // í•„í„° ê¸°ëŠ¥
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentFilter = btn.dataset.filter;
                renderCourses();
            });
        });

        // ê²€ìƒ‰ ê¸°ëŠ¥
        document.getElementById('searchInput').addEventListener('input', renderCourses);

        // ì´ˆê¸° ë Œë”ë§
        renderCourses();
        updateStats();
        
        // ì²« ë²ˆì§¸ í•„í„° ë²„íŠ¼ í™œì„±í™”
        document.querySelector('.filter-btn[data-filter="all"]').classList.add('active');
    </script>
</body>
</html>
